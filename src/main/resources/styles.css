:root {
    --row-fill: #ffc837;
    --isUser-fill: #65d635;
    --warning-fill: #ffa537;
    --error-fill: #c24343;
    --dps: #29ff6f;

    --text-color: rgb(255, 255, 255);
    --text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);

    --rounded-lg: 16px;
    --rounded: 12px;
    --rounded-sm: 8px;
    --rounded-xs: 6px;

    /* 글래스모피즘 테마 색상 */
    --glass-bg: rgba(20, 25, 40, 0.65);
    --glass-border: rgba(255, 255, 255, 0.12);
    --glass-highlight: rgba(255, 255, 255, 0.05);

    --title: rgba(255, 255, 255, 0.95);
}

* {
    font-family: "Spoqa Han Sans Neo", -apple-system, BlinkMacSystemFont, sans-serif;
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-user-select: none;
    user-select: none;
}

body {
    background: radial-gradient(circle at 50% -20%, #2b354f, #0f172a 60%, #000000);
    min-height: 100vh;
    color: white;
    overflow-y: scroll;
}

.container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 40px 20px;
    display: flex;
    flex-direction: column;
    gap: 20px;
    position: relative; /* 자식 요소 배치 기준 */
}

/* 공통 유리 카드 스타일 */
.meter, .detailsPanel {
    background: var(--glass-bg);
    backdrop-filter: blur(16px) saturate(180%);
    -webkit-backdrop-filter: blur(16px) saturate(180%);
    border: 1px solid var(--glass-border);
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
    border-radius: var(--rounded-lg);
    transition: all 0.3s ease;
}

/* --- 메인 미터기 프레임 --- */
.meter {
    width: 100%;
    position: relative;
    overflow: visible;
    min-height: auto; /* 내용물만큼만 높이 차지 */
    display: flex;
    flex-direction: column;
    z-index: 1; /* 낮은 우선순위 */
}

.header {
    display: flex;
    align-items: center;
    align-content: center;
    gap: 16px;
    padding: 8px 12px;
    flex: 0 0 auto;
}

.header .bossIcon {
    display: flex;
    align-items: center;
    width: 88px;
}
.header .bossIcon img {
    -webkit-user-drag: none;
    width: 100%;
}

.header .bossNames {
    flex: 1;
    color: var(--text-color);
    text-shadow: var(--text-shadow);
    font-weight: bold;
    height: 24px;
    display: flex;
    align-items: center;
    font-size: 16px;
}

.header .headerBtns {
    display: flex;
    align-items: center;
    font-weight: bold;
    color: white;
    gap: 8px;
    text-shadow: var(--text-shadow);
    cursor: pointer;
}

.header .headerBtns .headerBtn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    border-radius: 4px;
    transition: background 0.2s;
}

.header .headerBtns .headerBtn:hover {
    background: rgba(255, 255, 255, 0.15);
}

.header .headerBtns .headerBtn:active {
    transform: scale(0.95);
}

.header .headerBtns .headerBtn.resetBtn.is-danger {
    width: auto;
    height: 24px;
    padding: 0 12px;
    background: rgba(220, 38, 38, 0.85);
    border: 1px solid rgba(255, 100, 100, 0.5);
    border-radius: 4px;
    font-size: 13px;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
}

.header .headerBtns .headerBtn.resetBtn.is-danger:hover {
    background: rgba(220, 38, 38, 1);
    box-shadow: 0 0 8px rgba(255, 0, 0, 0.6);
}

.header .headerBtns .headerBtn.resetBtn.is-danger:active {
    transform: scale(0.96);
}

/* 리스트 영역 */
.list {
    display: grid;
    gap: 4px;
    padding: 0px 12px;
    flex: 1;
}

.list:has(.item:not([style*="display: none"])) {
    padding: 4px 12px 12px;
}

.list .item {
    position: relative;
    height: 36px;
    padding: 0 8px;
    border-radius: var(--rounded-xs);
    overflow: hidden;
    background: rgba(0, 0, 0, 0.3);
    cursor: pointer;
}

.list .item.isUser .fill { background: var(--isUser-fill); }
.list .item.warning .fill { background: var(--warning-fill); }
.list .item.error .fill { background: var(--error-fill); }

.list .fill {
    position: absolute;
    inset: 0;
    background: var(--row-fill);
    transform-origin: left center;
    transform: scaleX(0);
    transition: transform 150ms ease;
}

.list .content {
    position: relative;
    height: 100%;
    display: flex;
    align-items: center;
    gap: 8px;
}

.list .content .classIcon {
    width: 26px;
    display: flex;
    align-items: center;
    justify-content: center;
}
.list .content .classIcon .classIconImg {
    width: 100%;
    height: 100%;
}

.list .content .name {
    flex: 1;
    color: var(--text-color);
    font-size: 18px;
    text-shadow: var(--text-shadow);
    font-weight: bold;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
}

.list .content .dps {
    color: var(--dps);
    font-size: var(--font);
    text-shadow: var(--text-shadow);
    font-weight: bold;
    display: flex;
    align-items: center;
    gap: 8px;
}


/* --- [상세 정보 패널] 화면 중앙 대형 글래스 모달 --- */
.detailsPanel {
    /* 부모(.meter)의 영향 없이 화면 전체 기준 배치 */
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);

    /* 미터기보다 더 크게, 화면 중앙에 */
    width: 90vw;
    max-width: 1100px;
    height: 85vh;
    max-height: 900px;

    z-index: 9999; /* 최상단 레이어 보장 */

    display: none;
    flex-direction: column;

    /* 모달 유리 효과 */
    background: rgba(20, 25, 40, 0.75);
    backdrop-filter: blur(25px) saturate(180%);
    -webkit-backdrop-filter: blur(25px) saturate(180%);

    border: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.6); /* 더 깊은 그림자 */
    border-radius: 24px;

    padding: 0;
    color: white;
    font-weight: bold;

    /* 등장 애니메이션 */
    animation: zoomInModal 0.3s cubic-bezier(0.19, 1, 0.22, 1);
}

.detailsPanel.open {
    display: flex;
}

/* 상세화면 헤더 */
.detailsPanel .detailsHeader {
    display: flex;
    align-items: center;
    color: var(--title);
    flex: 0 0 auto;
    padding: 16px 24px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(255, 255, 255, 0.02);
    margin-bottom: 0;
}

.detailsPanel .detailsHeader .tooltip {
    opacity: 0.6;
    margin-left: 12px;
    font-size: 12px;
}

.detailsPanel .detailsHeader .closeX {
    cursor: pointer;
    margin-left: auto;
    user-select: none;
    font-size: 22px;
    padding: 2px 8px;
    border-radius: 4px;
    transition: 0.2s;
}

.detailsPanel .detailsHeader .closeX:hover {
    background: rgba(255, 255, 255, 0.08);
}

/* 상세화면 본문 (스크롤) */
.detailsPanel .detailsBody {
    flex: 1 1 auto;
    overflow-y: auto;
    padding: 20px 0;
    scrollbar-gutter: stable;
}

.detailsPanel .detailsBody::-webkit-scrollbar { width: 8px; }
.detailsPanel .detailsBody::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 4px; }
.detailsPanel .detailsBody::-webkit-scrollbar-track { background: transparent; }

/* 상세 스탯 그리드 */
.detailsStats {
    display: grid;
    gap: 12px 24px;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    padding: 0 24px 24px 24px;
}

.detailsStats .stat {
    display: flex;
    justify-content: space-between;
    gap: 12px;
    background: rgba(0,0,0,0.2);
    padding: 12px 16px;
    border-radius: var(--rounded);
}

/* 스킬 테이블 */
.detailsSkills .cell { min-width: 60px; }
.detailsSkills .cell.center { text-align: center; }
.detailsSkills .cell.right { text-align: right; }
.detailsSkills .cell.dmg { flex: 1; text-align: center; }
.detailsSkills .cell.name {
    flex: 0 0 210px;
    color: var(--row-fill);
}

.detailsSkills .skillHeader {
    display: flex;
    align-items: center;
    gap: 24px;
    padding: 12px 24px;
    background: rgba(0, 0, 0, 0.2);
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
}

.detailsSkills .skillHeader .cell.name { color: white; }

.detailsSkills .skills {
    max-height: none;
    overflow: visible;
    padding: 0 24px;
    background: transparent;
}

.detailsSkills .skills .skillRow {
    display: flex;
    align-items: center;
    gap: 24px;
    padding: 6px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
}

.detailsSkills .skills .skillRow:last-child { border-bottom: none; }

.detailsSkills .skills .skillRow .cell.dmg {
    position: relative;
    overflow: hidden;
    height: 32px;
}

.detailsSkills .skills .skillRow .cell.dmg .dmgFill {
    position: absolute;
    inset: 0;
    background: var(--isUser-fill);
    border-radius: var(--rounded-xs);
    transform-origin: left center;
}

.detailsSkills .skills .skillRow .cell.dmg .dmgText {
    position: relative;
    z-index: 1;
    height: 100%;
    display: flex;
    justify-content: end;
    align-items: center;
    text-shadow: var(--text-shadow);
    color: var(--dps);
    padding-right: 8px;
}

/* 애니메이션 */
@keyframes zoomInModal {
    from {
        opacity: 0;
        transform: translate(-50%, -45%) scale(0.95);
    }
    to {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
    }
}

/* 업데이트 모달 (기존 유지) */
.updateModal {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 999999;
}
.updateModal.isOpen { display: flex; }

.updateModal .updateModalCard {
    width: 360px;
    border-radius: 24px;
    background: rgb(12, 22, 40);
    padding: 24px;
    font-weight: bold;
    color: white;
}
.updateModal .updateModalCard .updateModalTitle { font-size: 24px; }
.updateModal .updateModalCard .updateModalText { margin: 24px 0px; white-space: pre-line; }
.updateModal .updateModalCard .updateModalActions .updateModalBtn {
    border: none;
    background: var(--error-fill);
    font-size: 18px;
    font-weight: bold;
    border-radius: 8px;
    padding: 8px;
    width: 100%;
    cursor: pointer;
    color: white;
    text-shadow: var(--text-shadow);
}

/* --- 모바일 반응형 --- */
@media screen and (max-width: 768px) {
    /* 로고 숨김 */
    .header .bossIcon {
        display: none;
    }

    /* 상세창 풀스크린 모드 */
    .detailsPanel {
        width: 100vw;
        height: 100%;
        max-width: none;
        max-height: none;
        border-radius: 0;
    }

    .container {
        padding: 10px;
        gap: 12px;
        width: 100%;
    }

    .detailsPanel .detailsHeader { padding: 12px 16px; }
    .detailsPanel .detailsBody { padding: 12px 0; }
    .detailsStats { padding: 0 16px 16px 16px; }

    /* 카드형 스킬 리스트 */
    .detailsSkills .skillHeader { display: none; }
    .detailsSkills .skills { padding: 0 16px; }

    .detailsSkills .skills .skillRow {
        flex-wrap: wrap;
        background: rgba(255, 255, 255, 0.03);
        margin-bottom: 8px;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.05);
        gap: 8px;
    }

    .detailsSkills .skills .skillRow .cell.name {
        flex: 1 1 100%;
        font-size: 15px;
        margin-bottom: 4px;
        color: var(--row-fill);
    }

    .detailsSkills .skills .skillRow .cell.dmg {
        flex: 1 1 100%;
        height: 24px;
        order: 3;
        margin-top: 4px;
    }

    .detailsSkills .skills .skillRow .cell.center {
        display: flex !important;
        align-items: center;
        justify-content: center;
        font-size: 11px;
        background: rgba(0, 0, 0, 0.3);
        padding: 2px 8px;
        border-radius: 4px;
        color: #ccc;
        min-width: auto;
        flex: 0 0 auto;
    }

    .detailsSkills .skills .skillRow .cell.crit::before { content: "치명 "; opacity: 0.6; margin-right: 4px; }
    .detailsSkills .skills .skillRow .cell.back::before { content: "백 "; opacity: 0.6; margin-right: 4px; }

    .detailsSkills .cell { min-width: 0; }
}

/* --- 상단 분석 이동 버튼 스타일 --- */
.analysis-link {
    display: flex;
    align-items: center;
    justify-content: space-between;

    /* 기존 미터기와 동일한 유리 효과 */
    background: var(--glass-bg);
    backdrop-filter: blur(16px) saturate(180%);
    -webkit-backdrop-filter: blur(16px) saturate(180%);
    border: 1px solid var(--glass-border);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);

    border-radius: var(--rounded-lg); /* 16px */
    padding: 16px 20px;
    margin-bottom: 0px; /* 컨테이너 gap이 있어서 마진 없어도 됨 */

    text-decoration: none;
    color: var(--text-color);
    font-weight: bold;
    font-size: 16px;

    transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    cursor: pointer;
    position: relative;
    overflow: hidden;
}

/* 내부 라벨 정렬 */
.analysis-link .link-label {
    display: flex;
    align-items: center;
    gap: 12px;
}

/* 화살표 아이콘 스타일 */
.analysis-link .arrow {
    opacity: 0.5;
    transition: transform 0.2s ease, opacity 0.2s ease;
}

/* 호버 효과 */
.analysis-link:hover {
    background: rgba(255, 255, 255, 0.08); /* 살짝 밝게 */
    transform: translateY(-2px); /* 살짝 위로 */
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
    border-color: rgba(255, 255, 255, 0.25);
}

.analysis-link:hover .arrow {
    transform: translateX(4px); /* 화살표 오른쪽 이동 */
    opacity: 1;
}

/* 클릭(Active) 효과 */
.analysis-link:active {
    transform: scale(0.98);
}
/* styles.css의 .battleTime 관련 부분을 이것으로 교체하세요 */

.battleTime {
    display: none;
    justify-content: space-between; /* 좌우 끝으로 벌리기 */
    align-items: center;
    padding: 6px 16px 10px;
    flex: 0 0 auto;
}

.battleTime.isVisible {
    display: flex;
}

/* --- [신규] 왼쪽 그룹 (상태 점 + 시간) --- */
.time-group {
    display: flex;
    align-items: center;
    gap: 8px; /* 점과 시간 사이 간격 */
}

/* 상태 점 */
.battleTime .status {
    width: 10px;
    height: 10px;
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.25);
    box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.25);
}

.battleTime.state-fighting .status { background: var(--dps); box-shadow: 0 0 5px var(--dps); }
.battleTime.state-grace .status { background: var(--warning-fill); }
.battleTime.state-ended .status { background: rgba(255, 255, 255, 0.28); }

/* 시간 텍스트 */
.battleTime .tick {
    color: rgba(255, 255, 255, 0.9);
    text-shadow: var(--text-shadow);
    font-weight: 700;
    font-size: 15px;
    font-variant-numeric: tabular-nums;
    letter-spacing: 0.5px;
}

/* --- 총 피해량 박스 (오른쪽) --- */
.total-dmg-box {
    display: flex;
    align-items: center;
    gap: 6px;

    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: var(--rounded-xs);
    padding: 3px 10px;
}

.total-dmg-box .label {
    color: rgba(255, 255, 255, 0.5);
    font-size: 11px;
    font-weight: 500;
    text-transform: uppercase;
    margin-top: 1px;
}

.total-dmg-box .totalDamage {
    color: var(--row-fill);
    font-weight: 800;
    font-size: 14px;
    text-shadow: 0 1px 5px rgba(0, 0, 0, 0.5);
    font-family: "Spoqa Han Sans Neo", monospace;
    letter-spacing: 0.5px;
}